(()=>{function l(t,e){this.tocList=t,this.elementList=function t(e,n){if(null==e)return null;var i=e.children;if(0===i.length)return null;for(var s=[],l=0;l<i.length;l++){var o=i[l];-1!==n.indexOf(o.tagName)&&s.push(o),s.push.apply(s,t(o,n))}return s}(e,this.tocList),this.eIndex=0,this.build=function(){if(null!=this.elementList&&0!==this.elementList.length)return this.analysis(-1,this.tocList.indexOf(this.elementList[this.eIndex].tagName))},this.analysis=function(t,e){for(var n="<ul class='menu-list'>";this.eIndex<this.elementList.length;){var i=this.elementList[this.eIndex],s=this.tocList.indexOf(i.tagName);if(t<s&&s<=e){e=s;var l=i.id,o=i.innerText;if(null!=l&&""!==l||(l=o+"_"+this.eIndex,i.setAttribute("id",l)),n+=`<li><a data-id="#${l}"><i class="fa fa-paperclip"></i>${o}</a>`,this.eIndex++,this.eIndex>=this.elementList.length){n+="</li>";break}(s=this.tocList.indexOf(this.elementList[this.eIndex].tagName))>e&&(n+=this.analysis(e,s)),n+="</li>"}else if(s<=t)break}return n+"</ul>"}}function t(t){const r=new Set,i=new Map,s=Array.from(t.querySelectorAll(".menu-list > li > a"));for(const t of s){const r=t.getAttribute("data-id").trim().slice(1),s=document.getElementById(r);s&&i.set(s,t)}const l=Array.from(i.keys()),e=new IntersectionObserver(e=>{for(const i of e)i.isIntersecting?r.add(i.target):r.delete(i.target);let n;if(r.size?n=[...r].sort((t,e)=>t.offsetTop-e.offsetTop)[0]:l.length&&(n=l.filter(t=>t.offsetTop<window.scrollY).sort((t,e)=>e.offsetTop-t.offsetTop)[0]),n&&i.has(n)){s.forEach(t=>t.classList.remove("is-active"));const e=i.get(n);e.classList.add("is-active");let t=e.parentElement.parentElement;for(;t.classList.contains("menu-list")&&"li"===t.parentElement.tagName.toLowerCase();)t.parentElement.children[0].classList.add("is-active"),t=t.parentElement.parentElement}},{threshold:0});for(const t of l){if(e.observe(t),i.has(t)){const r=i.get(t);r.addEventListener("click",()=>{let n,t=document.getElementById(r.getAttribute("data-id").substring(1)).getBoundingClientRect(),i=window.pageYOffset,s=i+t.top-50,l=(s-i)/20,o=i>s?-1:1;window.requestAnimationFrame(function t(e){(i+=l)*o<s*o?(window.scrollTo(0,i),n=window.requestAnimationFrame(t)):(window.scrollTo(0,s),window.cancelAnimationFrame(n))})})}i.has(t)&&(t.style.scrollMargin="1em")}}l.init=function(t){const e=t.tocList,n=t.contentElement,i=t.tocElement;if(null==e||0===e.length||null==n||null==i)return $(i).children().remove(),!1;for(var s=0;s<e.length;s++)e[s]=e[s].toUpperCase();t=new l(e,n).build();$(i).html(t)},window.tocPjax=function(){l.init({tocList:["h1","h2","h3","h4","h5"],contentElement:$(".main-content")[0],tocElement:".widget.toc .card-content"}),void 0!==window.IntersectionObserver&&document.querySelectorAll(".widget.toc").forEach(t)}})();